import { fetchJSON } from "../../utils/fetcher.js";


export async function getListings(req, res) {
  try {
    const limit = req.query.limit || 10;

    
    const result = await fetchJSON(
      `https://pro-api.coinmarketcap.com/v1/cryptocurrency/listings/latest?start=1&limit=${limit}&convert=USD`,
      {
        "X-CMC_PRO_API_KEY": process.env.CRYPTO_API_KEY
      }
    );
    return res.json(result?.data || result);
    

    // For now: return your hardcoded list
    // res.json(data);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
}


const data =
   [
  {
    "id": 1,
    "name": "Bitcoin",
    "symbol": "BTC",
    "slug": "bitcoin",
    "num_market_pairs": 12478,
    "date_added": "2010-07-13T00:00:00.000Z",
    "tags": [
      "mineable",
      "pow",
      "sha-256",
      "store-of-value",
      "state-channel",
      "coinbase-ventures-portfolio",
      "three-arrows-capital-portfolio",
      "polychain-capital-portfolio",
      "binance-labs-portfolio",
      "blockchain-capital-portfolio",
      "boostvc-portfolio",
      "cms-holdings-portfolio",
      "dcg-portfolio",
      "dragonfly-capital-portfolio",
      "electric-capital-portfolio",
      "fabric-ventures-portfolio",
      "framework-ventures-portfolio",
      "galaxy-digital-portfolio",
      "huobi-capital-portfolio",
      "alameda-research-portfolio",
      "a16z-portfolio",
      "1confirmation-portfolio",
      "winklevoss-capital-portfolio",
      "usv-portfolio",
      "placeholder-ventures-portfolio",
      "pantera-capital-portfolio",
      "multicoin-capital-portfolio",
      "paradigm-portfolio",
      "bitcoin-ecosystem",
      "layer-1",
      "ftx-bankruptcy-estate",
      "2017-2018-alt-season",
      "us-strategic-crypto-reserve",
      "binance-ecosystem",
      "binance-listing"
    ],
    "max_supply": 21000000,
    "circulating_supply": 19950015,
    "total_supply": 19950015,
    "infinite_supply": false,
    "platform": null,
    "cmc_rank": 1,
    "self_reported_circulating_supply": null,
    "self_reported_market_cap": null,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 94038.52389876294,
        "volume_24h": 85894311975.70898,
        "volume_change_24h": 59.3917,
        "percent_change_1h": 0.59428696,
        "percent_change_24h": -0.14784605,
        "percent_change_7d": -10.81373218,
        "percent_change_30d": -11.84726465,
        "percent_change_60d": -20.05260375,
        "percent_change_90d": -16.96107567,
        "market_cap": 1876069962358.1792,
        "market_cap_dominance": 58.6397,
        "fully_diluted_market_cap": 1974809001874.02,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 1027,
    "name": "Ethereum",
    "symbol": "ETH",
    "slug": "ethereum",
    "num_market_pairs": 11169,
    "date_added": "2015-08-07T00:00:00.000Z",
    "tags": [
      "pos",
      "smart-contracts",
      "ethereum-ecosystem",
      "coinbase-ventures-portfolio",
      "three-arrows-capital-portfolio",
      "polychain-capital-portfolio",
      "binance-labs-portfolio",
      "blockchain-capital-portfolio",
      "boostvc-portfolio",
      "cms-holdings-portfolio",
      "dcg-portfolio",
      "dragonfly-capital-portfolio",
      "electric-capital-portfolio",
      "fabric-ventures-portfolio",
      "framework-ventures-portfolio",
      "hashkey-capital-portfolio",
      "kenetic-capital-portfolio",
      "huobi-capital-portfolio",
      "alameda-research-portfolio",
      "a16z-portfolio",
      "1confirmation-portfolio",
      "winklevoss-capital-portfolio",
      "usv-portfolio",
      "placeholder-ventures-portfolio",
      "pantera-capital-portfolio",
      "multicoin-capital-portfolio",
      "paradigm-portfolio",
      "layer-1",
      "ftx-bankruptcy-estate",
      "sora-ecosystem",
      "rsk-rbtc-ecosystem",
      "world-liberty-financial-portfolio",
      "us-strategic-crypto-reserve",
      "binance-ecosystem",
      "binance-listing",
      "sophon-ecosystem"
    ],
    "max_supply": null,
    "circulating_supply": 120696215.48433027,
    "total_supply": 120696215.48433027,
    "infinite_supply": true,
    "platform": null,
    "cmc_rank": 2,
    "self_reported_circulating_supply": null,
    "self_reported_market_cap": null,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 3127.595898572018,
        "volume_24h": 38868426051.85283,
        "volume_change_24h": 57.6528,
        "percent_change_1h": 1.38238979,
        "percent_change_24h": 2.22425964,
        "percent_change_7d": -11.63806367,
        "percent_change_30d": -19.06176289,
        "percent_change_60d": -32.2185955,
        "percent_change_90d": -24.46830388,
        "market_cap": 377488988521.9559,
        "market_cap_dominance": 11.7991,
        "fully_diluted_market_cap": 377488988521.96,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 825,
    "name": "Tether USDt",
    "symbol": "USDT",
    "slug": "tether",
    "num_market_pairs": 158838,
    "date_added": "2015-02-25T00:00:00.000Z",
    "tags": [
      "stablecoin",
      "asset-backed-stablecoin",
      "usd-stablecoin",
      "fiat-stablecoin",
      "tron20-ecosystem",
      "rsk-rbtc-ecosystem",
      "venom-ecosystem",
      "world-liberty-financial-portfolio",
      "binance-ecosystem",
      "binance-listing",
      "peaq-ecosystem",
      "apertum-ecosystem",
      "etherlink-ecosystem",
      "duckchain-ecosystem",
      "onus-ecosystem",
      "sophon-ecosystem",
      "zedxion-smart-chain-ecosystem",
      "xlayer-ecosystem"
    ],
    "max_supply": null,
    "circulating_supply": 184040461847.42197,
    "total_supply": 186907505344.53983,
    "platform": {
      "id": 1027,
      "name": "Ethereum",
      "symbol": "ETH",
      "slug": "ethereum",
      "token_address": "0xdac17f958d2ee523a2206206994597c13d831ec7"
    },
    "infinite_supply": true,
    "cmc_rank": 3,
    "self_reported_circulating_supply": null,
    "self_reported_market_cap": null,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 0.9993719717144423,
        "volume_24h": 147649137654.8533,
        "volume_change_24h": 55.5126,
        "percent_change_1h": 0.04666283,
        "percent_change_24h": 0.01087573,
        "percent_change_7d": -0.03306527,
        "percent_change_30d": -0.10492003,
        "percent_change_60d": -0.09015754,
        "percent_change_90d": -0.06128945,
        "market_cap": 183924879231.69467,
        "market_cap_dominance": 5.7489,
        "fully_diluted_market_cap": 186790122144.4,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 52,
    "name": "XRP",
    "symbol": "XRP",
    "slug": "xrp",
    "num_market_pairs": 1760,
    "date_added": "2013-08-04T00:00:00.000Z",
    "tags": [
      "medium-of-exchange",
      "enterprise-solutions",
      "xrp-ecosystem",
      "arrington-xrp-capital-portfolio",
      "galaxy-digital-portfolio",
      "a16z-portfolio",
      "pantera-capital-portfolio",
      "ftx-bankruptcy-estate",
      "2017-2018-alt-season",
      "klaytn-ecosystem",
      "made-in-america",
      "us-strategic-crypto-reserve",
      "binance-ecosystem",
      "binance-listing"
    ],
    "max_supply": 100000000000,
    "circulating_supply": 60179002978,
    "total_supply": 99985763151,
    "infinite_supply": false,
    "platform": null,
    "cmc_rank": 4,
    "self_reported_circulating_supply": null,
    "self_reported_market_cap": null,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 2.213290984756695,
        "volume_24h": 5400283498.813156,
        "volume_change_24h": 58.6642,
        "percent_change_1h": 0.72393626,
        "percent_change_24h": 1.9754742,
        "percent_change_7d": -12.81669411,
        "percent_change_30d": -5.76401617,
        "percent_change_60d": -29.01527784,
        "percent_change_90d": -23.86092205,
        "market_cap": 133193644762.8537,
        "market_cap_dominance": 4.1659,
        "fully_diluted_market_cap": 221329098475.67,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 1839,
    "name": "BNB",
    "symbol": "BNB",
    "slug": "bnb",
    "num_market_pairs": 2969,
    "date_added": "2017-07-25T00:00:00.000Z",
    "tags": [
      "marketplace",
      "centralized-exchange",
      "payments",
      "smart-contracts",
      "alameda-research-portfolio",
      "multicoin-capital-portfolio",
      "bnb-chain-ecosystem",
      "layer-1",
      "alleged-sec-securities",
      "celsius-bankruptcy-estate",
      "binance-ecosystem",
      "binance-listing",
      "made-in-china"
    ],
    "max_supply": 137736906.31,
    "circulating_supply": 137736906.31,
    "total_supply": 137736906.31,
    "infinite_supply": false,
    "platform": null,
    "cmc_rank": 5,
    "self_reported_circulating_supply": null,
    "self_reported_market_cap": null,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 919.0491733388105,
        "volume_24h": 3470631235.467706,
        "volume_change_24h": 66.77,
        "percent_change_1h": 1.28187343,
        "percent_change_24h": 0.43163332,
        "percent_change_7d": -6.41099275,
        "percent_change_30d": -15.51799673,
        "percent_change_60d": -7.52774235,
        "percent_change_90d": 11.12185817,
        "market_cap": 126586989882.4507,
        "market_cap_dominance": 3.9592,
        "fully_diluted_market_cap": 126586989882.45,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 5426,
    "name": "Solana",
    "symbol": "SOL",
    "slug": "solana",
    "num_market_pairs": 1051,
    "date_added": "2020-04-10T00:00:00.000Z",
    "tags": [
      "pos",
      "platform",
      "solana-ecosystem",
      "cms-holdings-portfolio",
      "kenetic-capital-portfolio",
      "alameda-research-portfolio",
      "multicoin-capital-portfolio",
      "okx-ventures-portfolio",
      "layer-1",
      "ftx-bankruptcy-estate",
      "alleged-sec-securities",
      "cmc-crypto-awards-2024",
      "made-in-america",
      "us-strategic-crypto-reserve",
      "binance-ecosystem",
      "binance-listing"
    ],
    "max_supply": null,
    "circulating_supply": 554314124.3239305,
    "total_supply": 614239976.97637,
    "infinite_supply": true,
    "platform": null,
    "cmc_rank": 6,
    "self_reported_circulating_supply": 525236893.3,
    "self_reported_market_cap": 71196491857.93892,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 135.5512013076994,
        "volume_24h": 6547475325.809459,
        "volume_change_24h": 71.1211,
        "percent_change_1h": -0.44932995,
        "percent_change_24h": -0.07871987,
        "percent_change_7d": -18.67120399,
        "percent_change_30d": -26.36138426,
        "percent_change_60d": -46.1220958,
        "percent_change_90d": -23.3316775,
        "market_cap": 75137945453.9342,
        "market_cap_dominance": 2.3486,
        "fully_diluted_market_cap": 83260966770.36,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 3408,
    "name": "USDC",
    "symbol": "USDC",
    "slug": "usd-coin",
    "num_market_pairs": 34587,
    "date_added": "2018-10-08T00:00:00.000Z",
    "tags": [
      "medium-of-exchange",
      "stablecoin",
      "asset-backed-stablecoin",
      "stellar-ecosystem",
      "coinbase-ventures-portfolio",
      "usd-stablecoin",
      "xdc-ecosystem",
      "fiat-stablecoin",
      "tron20-ecosystem",
      "venom-ecosystem",
      "made-in-america",
      "world-liberty-financial-portfolio",
      "sonic-ecosystem",
      "binance-ecosystem",
      "binance-listing",
      "hyperevm-ecosystem",
      "etherlink-ecosystem",
      "unichain-ecosystem",
      "vector-smart-chain-ecosystem",
      "sophon-ecosystem",
      "xlayer-ecosystem"
    ],
    "max_supply": null,
    "circulating_supply": 74978033593.47246,
    "total_supply": 74978033593.47246,
    "platform": {
      "id": 1027,
      "name": "Ethereum",
      "symbol": "ETH",
      "slug": "ethereum",
      "token_address": "0xa0b86991c6218b36c1d19d4a2e9eb0ce3606eb48"
    },
    "infinite_supply": false,
    "cmc_rank": 7,
    "self_reported_circulating_supply": 60901219650.23,
    "self_reported_market_cap": 60896621723.823135,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 0.9999245018994156,
        "volume_24h": 17318141230.616558,
        "volume_change_24h": 94.9875,
        "percent_change_1h": 0.04461828,
        "percent_change_24h": -0.00486901,
        "percent_change_7d": -0.01239109,
        "percent_change_30d": 0.00368803,
        "percent_change_60d": 0.02117731,
        "percent_change_90d": 0.00316516,
        "market_cap": 74972372894.3506,
        "market_cap_dominance": 2.3434,
        "fully_diluted_market_cap": 74972372894.35,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 1958,
    "name": "TRON",
    "symbol": "TRX",
    "slug": "tron",
    "num_market_pairs": 1260,
    "date_added": "2017-09-13T00:00:00.000Z",
    "tags": [
      "media",
      "payments",
      "tron-ecosystem",
      "layer-1",
      "dwf-labs-portfolio",
      "alleged-sec-securities",
      "2017-2018-alt-season",
      "tron20-ecosystem",
      "world-liberty-financial-portfolio",
      "binance-ecosystem",
      "binance-listing",
      "made-in-china"
    ],
    "max_supply": null,
    "circulating_supply": 94671614402.8821,
    "total_supply": 94671622106.82019,
    "infinite_supply": true,
    "platform": null,
    "cmc_rank": 8,
    "self_reported_circulating_supply": 94667886298.43,
    "self_reported_market_cap": 27949345568.63262,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 0.2952357622153453,
        "volume_24h": 989167691.6064825,
        "volume_change_24h": 42.5638,
        "percent_change_1h": 0.67516132,
        "percent_change_24h": 1.57384541,
        "percent_change_7d": 0.35053005,
        "percent_change_30d": -5.87327846,
        "percent_change_60d": -15.70107774,
        "percent_change_90d": -15.18288008,
        "market_cap": 27950446238.39216,
        "market_cap_dominance": 0.8736,
        "fully_diluted_market_cap": 27950448512.87,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 74,
    "name": "Dogecoin",
    "symbol": "DOGE",
    "slug": "dogecoin",
    "num_market_pairs": 1348,
    "date_added": "2013-12-15T00:00:00.000Z",
    "tags": [
      "mineable",
      "pow",
      "scrypt",
      "medium-of-exchange",
      "memes",
      "payments",
      "doggone-doggerel",
      "osmosis-ecosystem",
      "ftx-bankruptcy-estate",
      "animal-memes",
      "made-in-america",
      "binance-ecosystem",
      "binance-listing"
    ],
    "max_supply": null,
    "circulating_supply": 151813086383.70523,
    "total_supply": 151813086383.70523,
    "infinite_supply": true,
    "platform": null,
    "cmc_rank": 9,
    "self_reported_circulating_supply": null,
    "self_reported_market_cap": null,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 0.16020602177290946,
        "volume_24h": 2518463211.086676,
        "volume_change_24h": 95.3671,
        "percent_change_1h": 1.83150988,
        "percent_change_24h": 2.50948925,
        "percent_change_7d": -10.35089978,
        "percent_change_30d": -14.41585966,
        "percent_change_60d": -43.77018304,
        "percent_change_90d": -24.59622771,
        "market_cap": 24321370622.600464,
        "market_cap_dominance": 0.7602,
        "fully_diluted_market_cap": 24321370622.6,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  },
  {
    "id": 2010,
    "name": "Cardano",
    "symbol": "ADA",
    "slug": "cardano",
    "num_market_pairs": 1627,
    "date_added": "2017-10-01T00:00:00.000Z",
    "tags": [
      "dpos",
      "pos",
      "platform",
      "research",
      "smart-contracts",
      "staking",
      "cardano-ecosystem",
      "cardano",
      "layer-1",
      "alleged-sec-securities",
      "2017-2018-alt-season",
      "made-in-america",
      "us-strategic-crypto-reserve",
      "binance-ecosystem",
      "binance-listing"
    ],
    "max_supply": 45000000000,
    "circulating_supply": 35877707945.18838,
    "total_supply": 44994677434.311554,
    "infinite_supply": false,
    "platform": null,
    "cmc_rank": 10,
    "self_reported_circulating_supply": 37997904336,
    "self_reported_market_cap": 18309373424.459072,
    "tvl_ratio": null,
    "last_updated": "2025-11-17T17:06:00.000Z",
    "quote": {
      "USD": {
        "price": 0.4818521901249273,
        "volume_24h": 1226148638.2934527,
        "volume_change_24h": 60.6006,
        "percent_change_1h": 1.87849305,
        "percent_change_24h": 0.64354724,
        "percent_change_7d": -17.31523466,
        "percent_change_30d": -23.4119611,
        "percent_change_60d": -47.98999248,
        "percent_change_90d": -44.49405877,
        "market_cap": 17287752150.051525,
        "market_cap_dominance": 0.5404,
        "fully_diluted_market_cap": 21683348555.62,
        "tvl": null,
        "last_updated": "2025-11-17T17:06:00.000Z"
      }
    }
  }
]
